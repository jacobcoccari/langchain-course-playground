import os
from dotenv import load_dotenv

from langchain.prompts import ChatPromptTemplate
from langchain.output_parsers import DatetimeOutputParser
from langchain.chat_models import ChatOpenAI


load_dotenv()
api_key = os.getenv("OPENAI_API_KEY")
model = ChatOpenAI(
    openai_api_key=api_key,
)


def main():
    output_parser = DatetimeOutputParser()
    system_prompt = "Do not return any output except for a datetime format."
    human_prompt = "{question} \n {format_instructions}"
    prompt_template = ChatPromptTemplate.from_messages(
        [
            system_prompt,
            human_prompt,
        ]
    )
    input = prompt_template.format_prompt(
        question="What date did world war two end?",
        format_instructions=output_parser.get_format_instructions(),
    ).to_messages()
    output = model(input).content
    result = output_parser.parse(output)
    print(result)
    print(type(result))


if __name__ == "__main__":
    main()
